<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/www/components/lavaca/src/ui/Scrollable.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/lavaca.env.Device.html">lavaca.env.Device</a></li>
            
                <li><a href="../classes/lavaca.events.EventDispatcher.html">lavaca.events.EventDispatcher</a></li>
            
                <li><a href="../classes/lavaca.fx.Animation.html">lavaca.fx.Animation</a></li>
            
                <li><a href="../classes/lavaca.fx.Transform.html">lavaca.fx.Transform</a></li>
            
                <li><a href="../classes/lavaca.fx.Transition.html">lavaca.fx.Transition</a></li>
            
                <li><a href="../classes/lavaca.mvc.Application.html">lavaca.mvc.Application</a></li>
            
                <li><a href="../classes/lavaca.mvc.AttributeEvent.html">lavaca.mvc.AttributeEvent</a></li>
            
                <li><a href="../classes/lavaca.mvc.Collection.html">lavaca.mvc.Collection</a></li>
            
                <li><a href="../classes/lavaca.mvc.Controller.html">lavaca.mvc.Controller</a></li>
            
                <li><a href="../classes/lavaca.mvc.ItemEvent.html">lavaca.mvc.ItemEvent</a></li>
            
                <li><a href="../classes/lavaca.mvc.Model.html">lavaca.mvc.Model</a></li>
            
                <li><a href="../classes/lavaca.mvc.Route.html">lavaca.mvc.Route</a></li>
            
                <li><a href="../classes/lavaca.mvc.Router.html">lavaca.mvc.Router</a></li>
            
                <li><a href="../classes/lavaca.mvc.View.html">lavaca.mvc.View</a></li>
            
                <li><a href="../classes/lavaca.mvc.ViewManager.html">lavaca.mvc.ViewManager</a></li>
            
                <li><a href="../classes/lavaca.net.Connectivity.html">lavaca.net.Connectivity</a></li>
            
                <li><a href="../classes/lavaca.net.History.html">lavaca.net.History</a></li>
            
                <li><a href="../classes/lavaca.storage.LocalStore.html">lavaca.storage.LocalStore</a></li>
            
                <li><a href="../classes/lavaca.storage.Store.html">lavaca.storage.Store</a></li>
            
                <li><a href="../classes/lavaca.ui.DustTemplate.html">lavaca.ui.DustTemplate</a></li>
            
                <li><a href="../classes/lavaca.ui.Form.html">lavaca.ui.Form</a></li>
            
                <li><a href="../classes/lavaca.ui.LoadingIndicator.html">lavaca.ui.LoadingIndicator</a></li>
            
                <li><a href="../classes/lavaca.ui.Scrollable.html">lavaca.ui.Scrollable</a></li>
            
                <li><a href="../classes/lavaca.ui.Template.html">lavaca.ui.Template</a></li>
            
                <li><a href="../classes/lavaca.ui.Widget.html">lavaca.ui.Widget</a></li>
            
                <li><a href="../classes/lavaca.util.ArrayUtils.html">lavaca.util.ArrayUtils</a></li>
            
                <li><a href="../classes/lavaca.util.Cache.html">lavaca.util.Cache</a></li>
            
                <li><a href="../classes/lavaca.util.Config.html">lavaca.util.Config</a></li>
            
                <li><a href="../classes/lavaca.util.DateUtils.html">lavaca.util.DateUtils</a></li>
            
                <li><a href="../classes/lavaca.util.delay.html">lavaca.util.delay</a></li>
            
                <li><a href="../classes/lavaca.util.Disposable.html">lavaca.util.Disposable</a></li>
            
                <li><a href="../classes/lavaca.util.extend.html">lavaca.util.extend</a></li>
            
                <li><a href="../classes/lavaca.util.log.html">lavaca.util.log</a></li>
            
                <li><a href="../classes/lavaca.util.Map.html">lavaca.util.Map</a></li>
            
                <li><a href="../classes/lavaca.util.Promise.html">lavaca.util.Promise</a></li>
            
                <li><a href="../classes/lavaca.util.resolve.html">lavaca.util.resolve</a></li>
            
                <li><a href="../classes/lavaca.util.StringUtils.html">lavaca.util.StringUtils</a></li>
            
                <li><a href="../classes/lavaca.util.Translation.html">lavaca.util.Translation</a></li>
            
                <li><a href="../classes/lavaca.util.uuid.html">lavaca.util.uuid</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: src/www/components/lavaca/src/ui/Scrollable.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
define(function(require) {

  var $ = require(&#x27;$&#x27;),
      Widget = require(&#x27;./Widget&#x27;),
      iScroll = require(&#x27;iScroll&#x27;),
      delay = require(&#x27;lavaca/util/delay&#x27;);

  var _props = [&#x27;overflowScrolling&#x27;, &#x27;webkitOverflowScrolling&#x27;, &#x27;MozOverflowScrolling&#x27;, &#x27;OOverflowScrolling&#x27;, &#x27;MSOverflowScrolling&#x27;],
      _isSupported,
      _isIOS5;

  (function() {
    var div = document.createElement(&#x27;div&#x27;),
        style = div.style,
        i = -1,
        s;

    _isIOS5 = /OS 5_\d(_\d)? like Mac OS X/i.test(navigator.userAgent);
    while (!!(s = _props[++i])) {
      if (s in style) {
        _isSupported = true;
        return;
      }
    }
    _isSupported = typeof div.ontouchstart !== &#x27;function&#x27;;
  })();

  /**
   * Overflow Scroll Container for mobile using overflow scrolling: touch or iScroll
   * @class lavaca.ui.Scrollable
   * @extends lavaca.ui.Widget
   * 
   * @constructor
   * @param {jQuery} el  The DOM element that is the root of the widget
   */
  var Scrollable = Widget.extend(function() {
    Widget.apply(this, arguments);
    if (!this.iScrollOptions) {
      this.iScrollOptions = {};
    }
    if (this.supportsOverflow) {
      this.initOverflowScroll();
    } else {
      this.className = &#x27;synthetic-scroll&#x27;;
      this.initIScroll();
    }
  }, {
    /**
     * True when overflowScrolling is supported in the Browser
     * @property {Boolean} supportsOverflow
     * @default false
     */
    supportsOverflow: _isSupported,
    /**
     * Activates the loading indicator
     * @property {String} className
     * @default &#x27;overflow-scroll&#x27;
     */
    className: &#x27;overflow-scroll&#x27;,
    /**
     * iScroll options hash
     * @property {Object} iScrollOptions
     * @default null
     */
    iScrollOptions: null,
    /**
     * Creates a wrapper for iScroll&#x27;s scrolling content
     * @method wrapper
     *
     * @return {jQuery}  The wrapper element
     */
    wrapper: function() {
      return $(&#x27;&lt;div class=&quot;scroll-wrapper&quot;&gt;&lt;/div&gt;&#x27;);
    },
    /**
     * Initializes native overflow scrolling
     * @method createOverflowScroll
     */
    initOverflowScroll: function() {
      delay(function() {
        this.addOverflowClass();
      }, this);
      this.preventParentScroll();
    },
    /**
     * Instantiates iScroll
     * @method createOverflowScroll
     */
    initIScroll: function() {
      var wrapper = this.wrapper(),
        options = {},
        opt,
        value;
      for (opt in this.iScrollOptions) {
        value = this.iScrollOptions[opt];
        if (typeof value === &#x27;function&#x27;) {
          value = $.proxy(value, this);
        }
        options[opt] = value;
      }
      value = options.onBeforeScrollStart;
      options.onBeforeScrollStart = function(e) {
        var nodeType = (e.explicitOriginalTarget || e.target).nodeName;
        if (nodeType !== &#x27;SELECT&#x27; &amp;&amp; nodeType !== &#x27;OPTION&#x27; &amp;&amp; nodeType !== &#x27;INPUT&#x27; &amp;&amp; nodeType !== &#x27;TEXTAREA&#x27; &amp;&amp; nodeType !== &#x27;LABEL&#x27;) {
          e.preventDefault();
          e.stopPropagation();
        }
        if (value) {
          value.apply(this, arguments);
        }
      };
      this.el.addClass(this.className);
      wrapper.append(this.el.children());
      this.el.append(wrapper);
      this.iScroll = new iScroll(this.el[0], options);
      this.refresh();
    },
    /**
     * Delegates to public iScroll method with delay.
     * Must be called every time content changes inside of scrolling container.
     * @method refresh
     */
     refresh: function() {
       if (!this.supportsOverflow) {
         delay(function() {
           this.iScroll &amp;&amp; this.iScroll.refresh();
         }, this, 10);
       } else if (_isIOS5) {
         this.el.removeClass(this.className);
         delay(function() {
           this.addOverflowClass();
         }, this, 10);
       }
     },
     /**
      * Prevents a page from scrolling when overflow container reaches boundries
      * 
      * Based on ScrollFix v0.1
      * http://www.joelambert.co.uk
      *
      * Copyright 2011, Joe Lambert.
      * Free to use under the MIT license.
      * http://www.opensource.org/licenses/mit-license.php
      * @method preventParentScroll
     */
    preventParentScroll: function() {
      var el = this.el[0];
      this.el.off(&#x27;.preventParentScroll&#x27;).on(&#x27;touchstart.preventParentScroll&#x27;, function() {
        var startTopScroll = el.scrollTop;
        if (startTopScroll &lt;= 0) {
          el.scrollTop = 1;
        }
        if (startTopScroll + el.offsetHeight &gt;= el.scrollHeight) {
          el.scrollTop = el.scrollHeight - el.offsetHeight - 1;
        }
      });
    },
    addOverflowClass: function() {
      // Fix iOS5 scrolling bug
      if (_isIOS5) {
        var rawEl = this.el[0];
        if (rawEl.scrollHeight &gt; rawEl.clientHeight) {
          this.el.addClass(this.className);
        } else {
          this.el.removeClass(this.className);
        }
      } else {
        this.el.addClass(this.className);
      }
    },
     /**
      * Cleans up the widget
      * @method dispose
      */
    dispose: function() {
      if (this.isScroll) {
        this.iScroll.destroy();
      }
      Widget.prototype.dispose.call(this);
    }
  });

  return Scrollable;

});

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
